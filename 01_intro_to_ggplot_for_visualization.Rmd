---
title: "Introduction to ggplot for Visualization"
Date:  "`r Sys.Date()`"
output: html_notebook
---

The outline, explanations, and code examples for this workshop are derived from the work found in the [Data Visualization chapter](http://r4ds.had.co.nz/data-visualisation.html) of Hadley Wickham's book entitled [*R for Data Science*](http://r4ds.had.co.nz/), and Selva Prabhakaran's [short tutorial](http://r-statistics.co/ggplot2-Tutorial-With-R.html) and [Intro](http://r-statistics.co/Complete-Ggplot2-Tutorial-Part1-With-R-Code.html).  If you are borrowing or referring to this introduction, Please reference the source material for Wickham or Prabhakaran, as appropriate.  My sole goal with this document is to create and outline for a two hour workshop.  The intellectual work is clearly that of Wickham and/or Prabhakaran.  Solutions to Wickham's questions can be found in Jeffrey Arnold's [R for Data Science Solutions](https://jrnold.github.io/r4ds-exercise-solutions/).

## Prerequisites

You'll need

- R
- RStudio
- [Tidyverse](https://tidyverse.org/)

This tutorial assumes you already have R and RStudio installed.  Once you have launched RStudio, load the tidyverse super package of libraries:  `library(tidyverse)`.  Since the Tidyverse packages include the ggplot2 package you do not have to load ggplot2 separately.  If the `library(tidyverse)` command gives an error, you probably want to `install.packages("tidyverse")` before attaching the library.  Installation need only be done once.  Attaching the library must be done each time you launch R.

```{r message=FALSE, warning=FALSE}
library(tidyverse)
```


## Basic ggplot Syntax Looks like this

``` r
ggplot(data = <DATA>) + 
  <GEOM_FUNCTION>(mapping = aes(<MAPPINGS>))

```

- The data argument takes a Tibble (or data frame)
- The Geom_Function is a function to plot your visualization.

    - Some of the most common *geoms* are scatter plots, bar plots, and box plots.  
    - There are numerous geom_functions.  At some point you will want to [browse the well crafted documentation](https://ggplot2.tidyverse.org/reference/index.html).  
    
- The mapping function requires, minimally, the `[aes()](https://ggplot2.tidyverse.org/reference/aes.html)` function.  This enables you to assign assign the variables of your data frame to the appropriate axis in your plot.

Below is a basic example.  The `geom_point()` function generates a scatter plot from the on-board **mpg** tibble, a dataset of fuel economy data compiled by the US government. `displ` and `hwy` are variables in the dataset assigned to the x and y axis.


```{r message=FALSE, warning=FALSE}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy))
```


### The Data

As stated above, ggplot takes a tibble (data frame) for input.  More than that, one has to map the variables to the geom (~ axis).  Different *geoms* require different data types.  Knowing the difference between continuous, categorical, and discrete variables as well as how the data structures (factors, vectors, data/time, strings) interacts will be immensely helpful to you.  You can read all about that in Wickham's *R4DS* book.  Meanwhile, let's have a look at the `mpg` data we just visualized.  Look up the on-board dataset in the help:  `?mpg` to learn more about the variables.

```{r}
mpg
```



### Exercies

1. Make a scatter plot of `hwy` vs `cyl`. (Question from [R4DS](http://r4ds.had.co.nz/data-visualisation.html#exercises ) | [Solution](https://jrnold.github.io/r4ds-exercise-solutions/data-visualisation.html#exercise-3.2.4.))

## Tweaking

Wickham notes the are some data points that seem to fall outside the linear trend.  We can alter the levels of the aesthetics to test hypothesis about this. 

```{r echo=FALSE}
ggplot() + 
  geom_point(data = filter(mpg, class == "2seater"), 
             mapping = aes(x = displ, y = hwy),
             color = "blue") +
  geom_point(data = filter(mpg, class != "2seater"), 
             mapping = aes(x = displ, y = hwy),
             color = "orange")


```


### Aesthetics & Levels

- An **aethetic** is a visual property of objects in the plot.  For example: **shape**, **color**.

    - See Also: *size*, opacity (*alpha*), *stroke*

- Each property can have different **levels**.  For example some levels of shape are *circle*, *square*, *triangle*.  By adding variables and/or changing the levels of the aesthetics you can change the visual appearance.  The effectiveness of the different aesthetics will vary with the data type.  R will often provide warnings -- suppressed in this tutorial -- depending on the quality of the mapping association.  (Read the warnings and Google for help when you get confused.)

#### Color

Below, map a third variable, `class` variable to the color aesthetic.  

```{r}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy, color = class))
```

#### Shape

We can change the shape aesthetic in the same way as we changed the color.  Notice, R will only map to six distinct shapes.

```{r message=FALSE, warning=FALSE}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy, shape = class))
```

### Manuall vs Automatic aethetics

- When variables are set inside the `aes()` the levels are assigned dynamically.
- When the levels are manually set outside the `aes()` but still inside the geom, the levels are static according to the preference of the person writing the code.  Below see:  `color = "blue"` is outside the aesthetic but inside the geom function.

```{r}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy), color = "blue")
```

### Exercises

#### 3.3.1.1 

([Question](http://r4ds.had.co.nz/data-visualisation.html#exercises-1)) Whatâ€™s gone wrong with this code? Why are the points not blue? ([Solution](https://jrnold.github.io/r4ds-exercise-solutions/data-visualisation.html#exercise-3.3.1))

```{r}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy, color = "blue"))
```

#### 3.3.1.3

Map a continuous variable to color, size, and shape. How do these aesthetics behave differently for categorical vs. continuous variables?  [Solution](https://jrnold.github.io/r4ds-exercise-solutions/data-visualisation.html#exercise-3.3.3)

#### 3.3.1.4  

What happens if you map the same variable to multiple aesthetics? [Soluion](https://jrnold.github.io/r4ds-exercise-solutions/data-visualisation.html#exercise-3.3.4)

### Aethetics Revisited
#### Stroke

Above I noted that there are many different aesthetics including **shape**, **color**, *size*, opacity (*alpha*), and *stroke*.  Let's take a look at `stroke` and note two additional features...

- When using `stroke`, also use `fill`
- `stroke` may not work with every [shape](http://r4ds.had.co.nz/data-visualisation.html#fig:shapes).  Check the help pages for more information

```{r}
ggplot(mtcars, aes(wt, mpg)) +
  geom_point(shape = 21, colour = "black", fill = "white", size = 5, stroke = 5)
```

## Layers

multiple geometric objects

## Facets

## Statistical Transformations

## Dodge & Jitter

## Coordinate System 

### Flip

### Mapping

## Themes

## Legends

## Annotations

## Saving

